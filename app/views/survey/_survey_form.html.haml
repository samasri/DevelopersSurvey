-url = 'https://stackoverflow.com/questions/' + @threadID
- page = Nokogiri::HTML(open(url))

-# Remove all StackOverFlow JavaScript
- nodes = []
- page.css('head')[0].children.each do |child|
	- if child.name == 'meta' or child.name == 'link' then nodes.push(child) end
- head = page.css('head')[0]
- head.inner_html = ''
- nodes.each do |node| head.add_child node end
- body = page.css('body')[0]
- body.children.each do |child|
	- if child.name == 'script' or child.name == 'noscript' then child.remove end

-# Add our stylesheets and JavaScript
- additions = stylesheet_link_tag    'application', media: 'all'
- additions += javascript_include_tag 'application'
- additions += csrf_meta_tags
- head.inner_html += additions
-#
- def removeIfExist(page, componentSpecifier, multiple = false)
	- component = page.css(componentSpecifier)
	- if multiple 
		- unless component.empty?
			- component.each do |cmp| cmp.remove end
	- unless multiple
		- unless component.empty?
			- component[0].remove


-# Removing unnecessary components
- removeIfExist(page, '#left-sidebar')
- removeIfExist(page, '#js-gdpr-consent-banner')
- removeIfExist(page, '#dfp-tlb')
- removeIfExist(page, '#sidebar')
- removeIfExist(page, '#post-form')
- removeIfExist(page, '#tabs')
- removeIfExist(page, '#custom-header', true)
- removeIfExist(page, '.comment-user', true)
- removeIfExist(page, '.post-signature', true)
- removeIfExist(page, '.pl8', true) # Remove 'Ask Question' button

-# Highlighting quesitions
- @sentences.each do |answerID, sentenceTexts|
	- sentenceTexts.each do |sentenceText|
		- btn = link_to sentenceText, new_task_path, remote: true
		- highlightedAnswer = page.css('#' + answerID)[0].inner_html.gsub(sentenceText, '<mark>' + btn + '</mark>')
		- page.css('#' + answerID + ' p')[0].inner_html = highlightedAnswer

- # Adding modal div
- newDiv = Nokogiri::XML::Node.new('div', page)
- newDiv['class'] = 'modal fade'
- newDiv['id'] = 'modal'
- body.add_child(newDiv)

= html = page.to_html.html_safe
= link_to 'Next Thread', @nextPath, class: 'btn btn-primary', method: :post